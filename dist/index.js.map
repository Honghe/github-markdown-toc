{"version":3,"file":"index.js","sources":["../node_modules/svelte/shared.js","../src/app.html","../modules/event-emitter/index.js","../node_modules/isobject/index.js","../node_modules/is-plain-object/index.js","../modules/deep-assign/index.js","../modules/flux/index.js","../src/page-type.js","../src/check-js-enabled.js","../src/page.js","../src/action.js","../src/store.js","../src/index.js"],"sourcesContent":["function appendNode ( node, target ) {\n\ttarget.appendChild( node );\n}\n\nfunction insertNode ( node, target, anchor ) {\n\ttarget.insertBefore( node, anchor );\n}\n\nfunction detachNode ( node ) {\n\tnode.parentNode.removeChild( node );\n}\n\nfunction detachBetween ( before, after ) {\n\twhile ( before.nextSibling && before.nextSibling !== after ) {\n\t\tbefore.parentNode.removeChild( before.nextSibling );\n\t}\n}\n\nfunction teardownEach ( iterations, detach, start ) {\n\tfor ( var i = ( start || 0 ); i < iterations.length; i += 1 ) {\n\t\titerations[i].teardown( detach );\n\t}\n}\n\nfunction createElement ( name ) {\n\treturn document.createElement( name );\n}\n\nfunction createSvgElement ( name ) {\n\treturn document.createElementNS( 'http://www.w3.org/2000/svg', name );\n}\n\nfunction createText ( data ) {\n\treturn document.createTextNode( data );\n}\n\nfunction createComment () {\n\treturn document.createComment( '' );\n}\n\nfunction addEventListener ( node, event, handler ) {\n\tnode.addEventListener ( event, handler, false );\n}\n\nfunction removeEventListener ( node, event, handler ) {\n\tnode.removeEventListener ( event, handler, false );\n}\n\nfunction setAttribute ( node, attribute, value ) {\n\tnode.setAttribute ( attribute, value );\n}\n\nfunction setXlinkAttribute ( node, attribute, value ) {\n\tnode.setAttributeNS( 'http://www.w3.org/1999/xlink', attribute, value );\n}\n\nfunction getBindingGroupValue ( group ) {\n\tvar value = [];\n\tfor ( var i = 0; i < group.length; i += 1 ) {\n\t\tif ( group[i].checked ) value.push( group[i].__value );\n\t}\n\treturn value;\n}\n\nfunction get ( key ) {\n\treturn key ? this._state[ key ] : this._state;\n}\n\nfunction fire ( eventName, data ) {\n\tvar handlers = eventName in this._handlers && this._handlers[ eventName ].slice();\n\tif ( !handlers ) return;\n\n\tfor ( var i = 0; i < handlers.length; i += 1 ) {\n\t\thandlers[i].call( this, data );\n\t}\n}\n\nfunction observe ( key, callback, options ) {\n\tvar group = ( options && options.defer ) ? this._observers.pre : this._observers.post;\n\n\t( group[ key ] || ( group[ key ] = [] ) ).push( callback );\n\n\tif ( !options || options.init !== false ) {\n\t\tcallback.__calling = true;\n\t\tcallback.call( this, this._state[ key ] );\n\t\tcallback.__calling = false;\n\t}\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tvar index = group[ key ].indexOf( callback );\n\t\t\tif ( ~index ) group[ key ].splice( index, 1 );\n\t\t}\n\t};\n}\n\nfunction observeDev ( key, callback, options ) {\n\tvar c = ( key = '' + key ).search( /[^\\w]/ );\n\tif ( c > -1 ) {\n\t\tvar message = \"The first argument to component.observe(...) must be the name of a top-level property\";\n\t\tif ( c > 0 ) message += \", i.e. '\" + key.slice( 0, c ) + \"' rather than '\" + key + \"'\";\n\n\t\tthrow new Error( message );\n\t}\n\n\tvar group = ( options && options.defer ) ? this._observers.pre : this._observers.post;\n\n\t( group[ key ] || ( group[ key ] = [] ) ).push( callback );\n\n\tif ( !options || options.init !== false ) {\n\t\tcallback.__calling = true;\n\t\tcallback.call( this, this._state[ key ] );\n\t\tcallback.__calling = false;\n\t}\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tvar index = group[ key ].indexOf( callback );\n\t\t\tif ( ~index ) group[ key ].splice( index, 1 );\n\t\t}\n\t};\n}\n\nfunction on ( eventName, handler ) {\n\tif ( eventName === 'teardown' ) return this.on( 'destroy', handler );\n\n\tvar handlers = this._handlers[ eventName ] || ( this._handlers[ eventName ] = [] );\n\thandlers.push( handler );\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tvar index = handlers.indexOf( handler );\n\t\t\tif ( ~index ) handlers.splice( index, 1 );\n\t\t}\n\t};\n}\n\nfunction onDev ( eventName, handler ) {\n\tif ( eventName === 'teardown' ) {\n\t\tconsole.warn( \"Use component.on('destroy', ...) instead of component.on('teardown', ...) which has been deprecated and will be unsupported in Svelte 2\" );\n\t\treturn this.on( 'destroy', handler );\n\t}\n\n\tvar handlers = this._handlers[ eventName ] || ( this._handlers[ eventName ] = [] );\n\thandlers.push( handler );\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tvar index = handlers.indexOf( handler );\n\t\t\tif ( ~index ) handlers.splice( index, 1 );\n\t\t}\n\t};\n}\n\nfunction set ( newState ) {\n\tthis._set( newState );\n\t( this._root || this )._flush();\n}\n\nfunction _flush () {\n\tif ( !this._renderHooks ) return;\n\n\twhile ( this._renderHooks.length ) {\n\t\tvar hook = this._renderHooks.pop();\n\t\thook.fn.call( hook.context );\n\t}\n}\n\nvar proto = {\n\tget: get,\n\tfire: fire,\n\tobserve: observe,\n\ton: on,\n\tset: set,\n\t_flush: _flush\n};\n\nvar protoDev = {\n\tget: get,\n\tfire: fire,\n\tobserve: observeDev,\n\ton: onDev,\n\tset: set,\n\t_flush: _flush\n};\n\nfunction noop () {}\n\nfunction differs ( a, b ) {\n\treturn ( a !== b ) || ( a && ( typeof a === 'object' ) || ( typeof a === 'function' ) );\n}\n\nfunction dispatchObservers ( component, group, newState, oldState ) {\n\tfor ( var key in group ) {\n\t\tif ( !( key in newState ) ) continue;\n\n\t\tvar newValue = newState[ key ];\n\t\tvar oldValue = oldState[ key ];\n\n\t\tif ( newValue === oldValue && typeof newValue !== 'object' ) continue;\n\n\t\tvar callbacks = group[ key ];\n\t\tif ( !callbacks ) continue;\n\n\t\tfor ( var i = 0; i < callbacks.length; i += 1 ) {\n\t\t\tvar callback = callbacks[i];\n\t\t\tif ( callback.__calling ) continue;\n\n\t\t\tcallback.__calling = true;\n\t\t\tcallback.call( component, newValue, oldValue );\n\t\t\tcallback.__calling = false;\n\t\t}\n\t}\n}\n\nexport { noop, differs, dispatchObservers, appendNode, insertNode, detachNode, detachBetween, teardownEach, createElement, createSvgElement, createText, createComment, addEventListener, removeEventListener, setAttribute, setXlinkAttribute, getBindingGroupValue, get, fire, observe, observeDev, on, onDev, set, _flush, proto, protoDev };\n","<div class=\"github-markdown-toc\" aria-disabled=\"{{ !isEnabled }}\" aria-busy=\"{{ isLoading }}\" data-open=\"{{ isOpen }}\">\n  <nav id=\"github-markdown-toc__nav-panel\" aria-hidden=\"{{ !isOpen }}\">\n    <ol>\n      {{#each headers as header}}\n      <li data-level=\"{{ header.level }}\"><a href=\"{{ header.link }}\">{{ header.text }}</a></li>\n      {{/each}}\n    </ol>\n  </nav>\n  <button type=\"button\" on:click=\"onBtnClicked()\" class=\"toggle-btn\" aria-controls=\"github-markdown-toc__nav-panel\" disabled=\"{{ !isEnabled }}\"></button>\n</div>\n<script>\n  export default {\n    methods: {\n      onBtnClicked () {\n        if (this.get('isEnabled')) {\n          this.fire('toggle-nav')\n        }\n      }\n    }\n  }\n</script>\n","/**\r\n * event emitter\r\n */\r\nexport default class EventEmitter {\r\n  constructor () {\r\n    /** @private */\r\n    this._handlers = new Map()\r\n  }\r\n  /**\r\n   * @param {string|Symbol} type\r\n   * @param {function} handler\r\n   */\r\n  on (type, handler) {\r\n    if (!this._handlers.has(type)) {\r\n      this._handlers.set(type, new Set())\r\n    }\r\n    this._handlers.get(type).add(handler)\r\n  }\r\n  /**\r\n   * @param {string|Symbol} type\r\n   * @param {function} handler\r\n   * @returns {boolean}\r\n   */\r\n  off (type, handler) {\r\n    if (!this._handlers.has(type)) {\r\n      return false\r\n    }\r\n    return this._handlers.get(type).delete(handler)\r\n  }\r\n  /**\r\n   * @param {string|Symbol} type\r\n   * @param {*} data\r\n   */\r\n  emit (type, data) {\r\n    if (this._handlers.has(type)) {\r\n      this._handlers.get(type).forEach(func => func(data))\r\n    }\r\n  }\r\n}\r\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2015, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function isObject(val) {\n  return val != null && typeof val === 'object'\n    && !Array.isArray(val);\n};\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2015, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\n'use strict';\n\nvar isObject = require('isobject');\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nmodule.exports = function isPlainObject(o) {\n  var ctor,prot;\n  \n  if (isObjectObject(o) === false) return false;\n  \n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n  \n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n  \n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n  \n  // Most likely a plain Object\n  return true;\n};\n","import isPlainObject from 'is-plain-object'\r\n\r\n/**\r\n * @param {Object} obj\r\n * @returns {Object}\r\n */\r\nfunction copyObject (obj) {\r\n  let copy = {}\r\n  Object.entries(obj).forEach(([k, v]) => {\r\n    if (isPlainObject(v)) {\r\n      copy[k] = copyObject(v)\r\n    }\r\n  })\r\n  return Object.assign({}, obj, copy)\r\n}\r\n\r\n/**\r\n * @param {*} target\r\n * @param {...*} sources\r\n * @returns {Object}\r\n */\r\nexport default function deepAssign (target, ...sources) {\r\n  const copies = sources.map(source =>\r\n    isPlainObject(source) ? copyObject(source) : source\r\n  )\r\n  return Object.assign(target, ...copies)\r\n}\r\n","import EventEmitter from '../event-emitter/index.js'\nimport deepAssign from '../deep-assign/index.js'\nconst ON_CHANGE = Symbol('on-change')\n\nexport class Action {\n  /**\n   * @param {EventEmitter} dispatcher\n   */\n  constructor (dispatcher) {\n    /** @private */\n    this._dispatcher = dispatcher\n  }\n  /**\n   * Emit a event with data\n   * @param {Symbol} key - event name\n   * @param {*} data\n   */\n  dispatch (key, data) {\n    this._dispatcher.emit(key, data)\n  }\n}\n\nexport class Store extends EventEmitter {\n  /**\n   * @param {EventEmitter} dispatcher\n   */\n  constructor (dispatcher) {\n    super()\n    /** @private */\n    this._state = {}\n    /** @private */\n    this._dispatcher = dispatcher\n  }\n  /**\n   * @param {Object} data\n   */\n  setState (data) {\n    this._state = deepAssign({}, this._state, data)\n    this.emit(ON_CHANGE)\n  }\n  /**\n   * @returns {Object}\n   */\n  getState () {\n    return deepAssign({}, this._state)\n  }\n  /**\n   * @param {Symbol} key\n   * @param {function} func\n   */\n  register (key, func) {\n    this._dispatcher.on(key, func)\n  }\n  /**\n   * @param {function} func\n   */\n  onChange (func) {\n    this.on(ON_CHANGE, func)\n  }\n  /**\n   * @param {function} func\n   * @returns {boolean}\n   */\n  removeChangeListener (func) {\n    return this.off(ON_CHANGE, func)\n  }\n}\n\nexport const Dispatcher = EventEmitter\n","export default class PageType {\r\n  /**\r\n   * @param {string} url\r\n   */\r\n  constructor (url) {\r\n    /** @public */\r\n    this.RELEASE = Symbol('release')\r\n    this.CODE = Symbol('code')\r\n    this.WIKI = Symbol('wiki')\r\n    this.UNKNOWN = Symbol('unknown')\r\n    const { pathname } = new URL(url)\r\n    // the first element is empty\r\n    const [, user, project, type, ...paths] = pathname.split('/')\r\n    if (type === 'releases' && paths.length === 0) {\r\n      this._type = this.RELEASE\r\n    } else if (type === 'blob' || type === 'tree' || (user && project && !type)) {\r\n      this._type = this.CODE\r\n    } else if (type === 'wiki') {\r\n      this._type = this.WIKI\r\n    } else {\r\n      this._type = this.UNKNOWN\r\n    }\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isReleasePage () {\r\n    return this._type === this.RELEASE\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isCodePage () {\r\n    return this._type === this.CODE\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isWikiPage () {\r\n    return this._type === this.WIKI\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isUnknownPage () {\r\n    return this._type === this.UNKNOWN\r\n  }\r\n}\r\n","/**\r\n * @returns {Promise<boolean, Error>}\r\n */\r\nexport default function checkJSEnebled () {\r\n  return new Promise(resolve => {\r\n    chrome.runtime.sendMessage({\r\n      type: 'is-js-enabled'\r\n    }, resolve)\r\n  })\r\n}\r\n","import PageType from './page-type.js'\r\nimport checkJSEnabled from './check-js-enabled.js'\r\n\r\n/*\r\n  WIP\r\n*/\r\n\r\n/**\r\n * @typedef {Object} HeaderObject\r\n * @property {string} link\r\n * @property {number} level\r\n * @property {string} text\r\n */\r\n\r\n/**\r\n * @typedef {HeaderObject[]} HeaderList\r\n */\r\n\r\n/**\r\n * @abstract\r\n */\r\nexport default class GitHubPage {\r\n  constructor () {\r\n    /** @private */\r\n    this.headerSelector = 'h1, h2, h3, h4, h5, h6'\r\n    /** @type {Element[]} */\r\n    this.headers = []\r\n  }\r\n  /**\r\n   * @returns {Promise<Array>}\r\n   */\r\n  async getHeaderList () {\r\n    return []\r\n  }\r\n  validateHeaders () {\r\n    this.headers = this.headers.filter(h => {\r\n      return Boolean(h.textContent.trim())\r\n    })\r\n  }\r\n  /**\r\n   * @param {string} url\r\n   */\r\n  static createFromUrl (url) {\r\n    const pagetype = new PageType(url)\r\n    if (pagetype.isReleasePage()) {\r\n      return new ReleasePage()\r\n    } else if (pagetype.isCodePage()) {\r\n      return new CodePage()\r\n    } else if (pagetype.isWikiPage()) {\r\n      return new WikiPage()\r\n    } else if (pagetype.isUnknownPage()) {\r\n      return new UnknownPage()\r\n    }\r\n  }\r\n}\r\n\r\nclass ReleasePage extends GitHubPage {\r\n  constructor () {\r\n    super()\r\n    this.headers = Array.from(document.querySelectorAll('.release-title'))\r\n    this.validateHeaders()\r\n  }\r\n  /**\r\n   * @returns {Promise<HeaderList, Error>}\r\n   */\r\n  async getHeaderList () {\r\n    return this.headers.map(h => {\r\n      const { href: link } = h.querySelector('a')\r\n      const text = h.textContent.trim()\r\n      /**\r\n       * @type {HeaderObject}\r\n       */\r\n      return {\r\n        link,\r\n        level: 1,\r\n        text\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nclass CodePage extends GitHubPage {\r\n  constructor () {\r\n    super()\r\n    const readme = document.querySelector('.markdown-body')\r\n    if (!readme) {\r\n      this.headers = []\r\n    } else {\r\n      this.headers = Array.from(readme.querySelectorAll(this.headerSelector))\r\n    }\r\n    this.validateHeaders()\r\n  }\r\n  /**\r\n   * @returns {Promise<HeaderList, Error>}\r\n   */\r\n  async getHeaderList () {\r\n    const isJSEnabled = await checkJSEnabled()\r\n    return this.headers.map(h => {\r\n      let { id, href } = h.querySelector('.anchor')\r\n      id = `#${id}`\r\n      href = new URL(href).hash\r\n      const link = isJSEnabled ? href : id\r\n      const level = Number(h.tagName[1])\r\n      const text = h.textContent.trim()\r\n      /**\r\n       * @type {HeaderObject}\r\n       */\r\n      return {\r\n        link,\r\n        level,\r\n        text\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nclass WikiPage extends GitHubPage {\r\n  constructor () {\r\n    super()\r\n    const markdown = document.querySelector('.wiki-body .markdown-body')\r\n    if (!markdown) {\r\n      this.headers = []\r\n    } else {\r\n      this.headers = Array.from(markdown.querySelectorAll(this.headerSelector))\r\n    }\r\n    this.validateHeaders()\r\n  }\r\n  /**\r\n   * @returns {Promise<HeaderList, Error>}\r\n   */\r\n  async getHeaderList () {\r\n    const isJSEnabled = await checkJSEnabled()\r\n    return this.headers.map(h => {\r\n      let { id, href } = h.querySelector('.anchor')\r\n      id = `#${id}`\r\n      href = new URL(href).hash\r\n      const link = isJSEnabled ? href : id\r\n      const level = Number(h.tagName[1])\r\n      const text = h.textContent.trim()\r\n      /**\r\n       * @type {HeaderObject}\r\n       */\r\n      return {\r\n        link,\r\n        level,\r\n        text\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nclass UnknownPage extends GitHubPage {\r\n}\r\n","import { Action } from '../modules/flux/index.js'\n// import fetchHeader from './get-header-data.js'\nimport GitHubPage from './page.js'\n\nexport const key = {\n  START_LOADING: Symbol('start-loading'),\n  MOVE_TO_PAGE: Symbol('move-to-page'),\n  TOGGLE_NAV: Symbol('toggle-nav')\n}\n\nexport default class AppAction extends Action {\n  startLoading () {\n    this.dispatch(key.START_LOADING)\n  }\n  async moveToPage () {\n    const page = GitHubPage.createFromUrl(location.href)\n    const headers = await page.getHeaderList()\n    const isAvailable = Boolean(headers.length)\n    const data = {\n      headers,\n      isAvailable\n    }\n    this.dispatch(key.MOVE_TO_PAGE, data)\n  }\n  toggleNav () {\n    this.dispatch(key.TOGGLE_NAV)\n  }\n}\n","import { Store } from '../modules/flux/index.js'\nimport { key } from './action.js'\n\nexport default class AppStore extends Store {\n  constructor (dispatcher) {\n    super(dispatcher)\n    this.setState({\n      isLoading: false,\n      isOpen: false,\n      isEnabled: false,\n      headers: []\n    })\n    this.register(key.START_LOADING, this.loading.bind(this))\n    this.register(key.MOVE_TO_PAGE, this.toPage.bind(this))\n    this.register(key.TOGGLE_NAV, this.toggleNav.bind(this))\n  }\n  loading () {\n    this.setState({\n      isLoading: true\n    })\n  }\n  toPage ({ isAvailable, headers }) {\n    this.setState({\n      headers,\n      isLoading: false,\n      isEnabled: isAvailable,\n      isOpen: isAvailable ? this.getState().isOpen : false\n    })\n  }\n  toggleNav () {\n    this.setState({\n      isOpen: !this.getState().isOpen\n    })\n  }\n}\n","'use strict'\n\nimport App from './app.html'\nimport { Dispatcher } from '../modules/flux/index.js'\nimport AppAction from './action.js'\nimport AppStore from './store.js'\n\nconst dispatcher = new Dispatcher()\nconst action = new AppAction(dispatcher)\nconst store = new AppStore(dispatcher)\n\nconst dataAttr = 'githubMarkdownTocOpen'\nconst body = document.body\n\nconst rootElm = document.createElement('github-markdown-toc-container')\nconst app = new App({\n  data: store.getState(),\n  target: rootElm\n})\nbody.appendChild(rootElm)\nstore.onChange(() => {\n  app.set(store.getState())\n})\nstore.onChange(() => {\n  const { isOpen } = store.getState()\n  if (isOpen) {\n    body.dataset[dataAttr] = ''\n  } else {\n    delete body.dataset[dataAttr]\n  }\n})\napp.on('toggle-nav', action.toggleNav.bind(action))\nwindow.addEventListener('pjax:start', action.startLoading.bind(action))\nwindow.addEventListener('pjax:end', action.moveToPage.bind(action))\n// init\naction.moveToPage()\n"],"names":["target","appendChild","node","insertBefore","anchor","parentNode","removeChild","start","i","iterations","length","teardown","detach","createElement","name","createTextNode","data","createComment","addEventListener","event","handler","removeEventListener","setAttribute","attribute","value","_state","key","eventName","_handlers","slice","handlers","call","options","defer","_observers","pre","post","group","push","callback","init","__calling","cancel","indexOf","index","splice","on","_set","newState","_root","_flush","_renderHooks","pop","hook","fn","context","get","fire","observe","set","oldState","newValue","oldValue","callbacks","component","methods","onBtnClicked","isEnabled","isLoading","isOpen","headers","header","level","link","text","constructor","has","type","add","off","delete","emit","forEach","func","Array","isArray","val","o","prototype","toString","ctor","prot","hasOwnProperty","entries","obj","isPlainObject","v","copy","k","copyObject","Object","assign","sources","map","source","copies","Symbol","_dispatcher","dispatcher","dispatch","setState","deepAssign","ON_CHANGE","getState","register","onChange","removeChangeListener","EventEmitter","RELEASE","CODE","WIKI","UNKNOWN","pathname","url","split","_type","user","project","isReleasePage","isCodePage","isWikiPage","isUnknownPage","chrome","runtime","sendMessage","resolve","headerSelector","validateHeaders","filter","h","textContent","trim","pagetype","from","document","querySelectorAll","href","querySelector","readme","id","hash","isJSEnabled","tagName","markdown","START_LOADING","MOVE_TO_PAGE","TOGGLE_NAV","startLoading","GitHubPage","createFromUrl","location","getHeaderList","isAvailable","toggleNav","loading","bind","toPage","action","store","dataAttr","body","rootElm","app","dataset","window","moveToPage"],"mappings":"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"}