{"version":3,"file":"index.js","sources":["../node_modules/svelte/shared.js","../src/app.html","../modules/event-emitter/index.js","../modules/is-plain-object/index.js","../modules/deep-assign/index.js","../modules/flux/index.js","../src/page-type.js","../src/check-js-enabled.js","../src/page.js","../src/action.js","../src/store.js","../src/index.js"],"sourcesContent":["function appendNode ( node, target ) {\n\ttarget.appendChild( node );\n}\n\nfunction insertNode ( node, target, anchor ) {\n\ttarget.insertBefore( node, anchor );\n}\n\nfunction detachNode ( node ) {\n\tnode.parentNode.removeChild( node );\n}\n\nfunction detachBetween ( before, after ) {\n\twhile ( before.nextSibling && before.nextSibling !== after ) {\n\t\tbefore.parentNode.removeChild( before.nextSibling );\n\t}\n}\n\nfunction destroyEach ( iterations, detach, start ) {\n\tfor ( var i = start; i < iterations.length; i += 1 ) {\n\t\titerations[i].destroy( detach );\n\t}\n}\n\nfunction createElement ( name ) {\n\treturn document.createElement( name );\n}\n\nfunction createSvgElement ( name ) {\n\treturn document.createElementNS( 'http://www.w3.org/2000/svg', name );\n}\n\nfunction createText ( data ) {\n\treturn document.createTextNode( data );\n}\n\nfunction createComment () {\n\treturn document.createComment( '' );\n}\n\nfunction addEventListener ( node, event, handler ) {\n\tnode.addEventListener( event, handler, false );\n}\n\nfunction removeEventListener ( node, event, handler ) {\n\tnode.removeEventListener( event, handler, false );\n}\n\nfunction setAttribute ( node, attribute, value ) {\n\tnode.setAttribute( attribute, value );\n}\n\nfunction setXlinkAttribute ( node, attribute, value ) {\n\tnode.setAttributeNS( 'http://www.w3.org/1999/xlink', attribute, value );\n}\n\nfunction getBindingGroupValue ( group ) {\n\tvar value = [];\n\tfor ( var i = 0; i < group.length; i += 1 ) {\n\t\tif ( group[i].checked ) value.push( group[i].__value );\n\t}\n\treturn value;\n}\n\nfunction noop () {}\n\nfunction assign ( target ) {\n\tfor ( var i = 1; i < arguments.length; i += 1 ) {\n\t\tvar source = arguments[i];\n\t\tfor ( var k in source ) target[k] = source[k];\n\t}\n\n\treturn target;\n}\n\nfunction differs ( a, b ) {\n\treturn ( a !== b ) || ( a && ( typeof a === 'object' ) || ( typeof a === 'function' ) );\n}\n\nfunction dispatchObservers ( component, group, newState, oldState ) {\n\tfor ( var key in group ) {\n\t\tif ( !( key in newState ) ) continue;\n\n\t\tvar newValue = newState[ key ];\n\t\tvar oldValue = oldState[ key ];\n\n\t\tif ( differs( newValue, oldValue ) ) {\n\t\t\tvar callbacks = group[ key ];\n\t\t\tif ( !callbacks ) continue;\n\n\t\t\tfor ( var i = 0; i < callbacks.length; i += 1 ) {\n\t\t\t\tvar callback = callbacks[i];\n\t\t\t\tif ( callback.__calling ) continue;\n\n\t\t\t\tcallback.__calling = true;\n\t\t\t\tcallback.call( component, newValue, oldValue );\n\t\t\t\tcallback.__calling = false;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction get ( key ) {\n\treturn key ? this._state[ key ] : this._state;\n}\n\nfunction fire ( eventName, data ) {\n\tvar handlers = eventName in this._handlers && this._handlers[ eventName ].slice();\n\tif ( !handlers ) return;\n\n\tfor ( var i = 0; i < handlers.length; i += 1 ) {\n\t\thandlers[i].call( this, data );\n\t}\n}\n\nfunction observe ( key, callback, options ) {\n\tvar group = ( options && options.defer ) ? this._observers.post : this._observers.pre;\n\n\t( group[ key ] || ( group[ key ] = [] ) ).push( callback );\n\n\tif ( !options || options.init !== false ) {\n\t\tcallback.__calling = true;\n\t\tcallback.call( this, this._state[ key ] );\n\t\tcallback.__calling = false;\n\t}\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tvar index = group[ key ].indexOf( callback );\n\t\t\tif ( ~index ) group[ key ].splice( index, 1 );\n\t\t}\n\t};\n}\n\nfunction observeDev ( key, callback, options ) {\n\tvar c = ( key = '' + key ).search( /[^\\w]/ );\n\tif ( c > -1 ) {\n\t\tvar message = \"The first argument to component.observe(...) must be the name of a top-level property\";\n\t\tif ( c > 0 ) message += \", i.e. '\" + key.slice( 0, c ) + \"' rather than '\" + key + \"'\";\n\n\t\tthrow new Error( message );\n\t}\n\n\treturn observe.call( this, key, callback, options );\n}\n\nfunction on ( eventName, handler ) {\n\tif ( eventName === 'teardown' ) return this.on( 'destroy', handler );\n\n\tvar handlers = this._handlers[ eventName ] || ( this._handlers[ eventName ] = [] );\n\thandlers.push( handler );\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tvar index = handlers.indexOf( handler );\n\t\t\tif ( ~index ) handlers.splice( index, 1 );\n\t\t}\n\t};\n}\n\nfunction onDev ( eventName, handler ) {\n\tif ( eventName === 'teardown' ) {\n\t\tconsole.warn( \"Use component.on('destroy', ...) instead of component.on('teardown', ...) which has been deprecated and will be unsupported in Svelte 2\" );\n\t\treturn this.on( 'destroy', handler );\n\t}\n\n\treturn on.call( this, eventName, handler );\n}\n\nfunction set ( newState ) {\n\tthis._set( assign( {}, newState ) );\n\t( this._root || this )._flush();\n}\n\nfunction _flush () {\n\tif ( !this._renderHooks ) return;\n\n\twhile ( this._renderHooks.length ) {\n\t\tvar hook = this._renderHooks.pop();\n\t\thook.fn.call( hook.context );\n\t}\n}\n\nvar proto = {\n\tget: get,\n\tfire: fire,\n\tobserve: observe,\n\ton: on,\n\tset: set,\n\t_flush: _flush\n};\n\nvar protoDev = {\n\tget: get,\n\tfire: fire,\n\tobserve: observeDev,\n\ton: onDev,\n\tset: set,\n\t_flush: _flush\n};\n\nexport { noop, assign, differs, dispatchObservers, get, fire, observe, observeDev, on, onDev, set, _flush, proto, protoDev, appendNode, insertNode, detachNode, detachBetween, destroyEach, createElement, createSvgElement, createText, createComment, addEventListener, removeEventListener, setAttribute, setXlinkAttribute, getBindingGroupValue };\n","<div class=\"github-markdown-toc\" aria-disabled=\"{{ !isEnabled }}\" aria-busy=\"{{ isLoading }}\" data-open=\"{{ isOpen }}\">\n  <nav id=\"github-markdown-toc__nav-panel\" aria-hidden=\"{{ !isOpen }}\">\n    <ol>\n      {{#each headers as header}}\n      <li data-level=\"{{ header.level }}\"><a href=\"{{ header.link }}\">{{ header.text }}</a></li>\n      {{/each}}\n    </ol>\n  </nav>\n  <button type=\"button\" on:click=\"onBtnClicked()\" class=\"toggle-btn\" aria-controls=\"github-markdown-toc__nav-panel\" disabled=\"{{ !isEnabled }}\"></button>\n</div>\n<script>\n  export default {\n    methods: {\n      onBtnClicked () {\n        if (this.get('isEnabled')) {\n          this.fire('toggle-nav')\n        }\n      }\n    }\n  }\n</script>\n","/**\r\n * event emitter\r\n */\r\nexport default class EventEmitter {\r\n  constructor () {\r\n    /** @private */\r\n    this._handlers = new Map()\r\n  }\r\n  /**\r\n   * @param {string|Symbol} type\r\n   * @param {function} handler\r\n   */\r\n  on (type, handler) {\r\n    if (!this._handlers.has(type)) {\r\n      this._handlers.set(type, new Set())\r\n    }\r\n    this._handlers.get(type).add(handler)\r\n  }\r\n  /**\r\n   * @param {string|Symbol} type\r\n   * @param {function} handler\r\n   * @returns {boolean}\r\n   */\r\n  off (type, handler) {\r\n    if (!this._handlers.has(type)) {\r\n      return false\r\n    }\r\n    return this._handlers.get(type).delete(handler)\r\n  }\r\n  /**\r\n   * @param {string|Symbol} type\r\n   * @param {*} data\r\n   */\r\n  emit (type, data) {\r\n    if (this._handlers.has(type)) {\r\n      this._handlers.get(type).forEach(func => func(data))\r\n    }\r\n  }\r\n}\r\n","/**\r\n * @param {*} obj\r\n * @returns {Boolean}\r\n */\r\nexport default function isPlainObject (obj) {\r\n  if (!obj) {\r\n    return false\r\n  }\r\n  const proto = Object.getPrototypeOf(obj)\r\n  return Object.prototype.toString.call(obj) === '[object Object]' && (proto === Object.getPrototypeOf({}) || proto === null)\r\n}\r\n","import isPlainObject from '../is-plain-object/index.js'\r\n\r\n/**\r\n * @param {Object} obj\r\n * @returns {Object}\r\n */\r\nfunction copyObject (obj) {\r\n  let copy = {}\r\n  Object.entries(obj).forEach(([k, v]) => {\r\n    if (isPlainObject(v)) {\r\n      copy[k] = copyObject(v)\r\n    }\r\n  })\r\n  return Object.assign({}, obj, copy)\r\n}\r\n\r\n/**\r\n * @param {*} target\r\n * @param {...*} sources\r\n * @returns {Object}\r\n */\r\nexport default function deepAssign (target, ...sources) {\r\n  const copies = sources.map(source =>\r\n    isPlainObject(source) ? copyObject(source) : source\r\n  )\r\n  return Object.assign(target, ...copies)\r\n}\r\n","import EventEmitter from '../event-emitter/index.js'\nimport deepAssign from '../deep-assign/index.js'\nconst ON_CHANGE = Symbol('on-change')\n\nexport class Action {\n  /**\n   * @param {EventEmitter} dispatcher\n   */\n  constructor (dispatcher) {\n    /** @private */\n    this._dispatcher = dispatcher\n  }\n  /**\n   * Emit a event with data\n   * @param {Symbol} key - event name\n   * @param {*} data\n   */\n  dispatch (key, data) {\n    this._dispatcher.emit(key, data)\n  }\n}\n\nexport class Store extends EventEmitter {\n  /**\n   * @param {EventEmitter} dispatcher\n   */\n  constructor (dispatcher) {\n    super()\n    /** @private */\n    this._state = {}\n    /** @private */\n    this._dispatcher = dispatcher\n  }\n  /**\n   * @param {Object} data\n   */\n  setState (data) {\n    this._state = deepAssign({}, this._state, data)\n    this.emit(ON_CHANGE)\n  }\n  /**\n   * @returns {Object}\n   */\n  getState () {\n    return deepAssign({}, this._state)\n  }\n  /**\n   * @param {Symbol} key\n   * @param {function} func\n   */\n  register (key, func) {\n    this._dispatcher.on(key, func)\n  }\n  /**\n   * @param {function} func\n   */\n  onChange (func) {\n    this.on(ON_CHANGE, func)\n  }\n  /**\n   * @param {function} func\n   * @returns {boolean}\n   */\n  removeChangeListener (func) {\n    return this.off(ON_CHANGE, func)\n  }\n}\n\nexport const Dispatcher = EventEmitter\n","export default class PageType {\r\n  /**\r\n   * @param {string} url\r\n   */\r\n  constructor (url) {\r\n    /** @public */\r\n    this.RELEASE = Symbol('release')\r\n    this.CODE = Symbol('code')\r\n    this.WIKI = Symbol('wiki')\r\n    this.UNKNOWN = Symbol('unknown')\r\n    const { pathname } = new URL(url)\r\n    // the first element is empty\r\n    const [, user, project, type, ...paths] = pathname.split('/')\r\n    if (type === 'releases' && paths.length === 0) {\r\n      this._type = this.RELEASE\r\n    } else if (type === 'blob' || type === 'tree' || (user && project && !type)) {\r\n      this._type = this.CODE\r\n    } else if (type === 'wiki') {\r\n      this._type = this.WIKI\r\n    } else {\r\n      this._type = this.UNKNOWN\r\n    }\r\n  }\r\n  /**\r\n   * @returns {Symbol}\r\n   */\r\n  getType () {\r\n    return this._type\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isReleasePage () {\r\n    return this._type === this.RELEASE\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isCodePage () {\r\n    return this._type === this.CODE\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isWikiPage () {\r\n    return this._type === this.WIKI\r\n  }\r\n  /**\r\n   * @returns {boolean}\r\n   */\r\n  isUnknownPage () {\r\n    return this._type === this.UNKNOWN\r\n  }\r\n}\r\n","/**\r\n * @returns {Promise<boolean, Error>}\r\n */\r\nexport default function checkJSEnebled () {\r\n  return new Promise(resolve => {\r\n    chrome.runtime.sendMessage({\r\n      type: 'is-js-enabled'\r\n    }, resolve)\r\n  })\r\n}\r\n","import PageType from './page-type.js'\r\nimport checkJSEnabled from './check-js-enabled.js'\r\n\r\n/*\r\n  WIP\r\n*/\r\n\r\n/**\r\n * @typedef {Object} HeaderObject\r\n * @property {string} link\r\n * @property {number} level\r\n * @property {string} text\r\n */\r\n\r\n/**\r\n * @typedef {HeaderObject[]} HeaderList\r\n */\r\n\r\n/**\r\n * @abstract\r\n */\r\nexport default class GitHubPage {\r\n  constructor () {\r\n    /** @private */\r\n    this._headerSelector = 'h1, h2, h3, h4, h5, h6'\r\n    /** @type {Element[]} */\r\n    this.headers = []\r\n  }\r\n  /**\r\n   * @returns {Promise<Array>}\r\n   */\r\n  async getHeaderList () {\r\n    return []\r\n  }\r\n  /**\r\n   * @private\r\n   */\r\n  _validateHeaders () {\r\n    this.headers = this.headers.filter(h => {\r\n      return Boolean(h.textContent.trim())\r\n    })\r\n  }\r\n  /**\r\n   * @param {string} url\r\n   */\r\n  static createFromUrl (url) {\r\n    const pagetype = new PageType(url)\r\n    if (pagetype.isReleasePage()) return new ReleasePage()\r\n    if (pagetype.isCodePage()) return new CodePage()\r\n    if (pagetype.isWikiPage()) return new WikiPage()\r\n    return new UnknownPage()\r\n  }\r\n}\r\n\r\nclass ReleasePage extends GitHubPage {\r\n  constructor () {\r\n    super()\r\n    this.headers = Array.from(document.querySelectorAll('.release-title'))\r\n    this._validateHeaders()\r\n  }\r\n  /**\r\n   * @returns {Promise<HeaderList, Error>}\r\n   */\r\n  async getHeaderList () {\r\n    return this.headers.map(h => {\r\n      const { href: link } = h.querySelector('a')\r\n      const text = h.textContent.trim()\r\n      /**\r\n       * @type {HeaderObject}\r\n       */\r\n      return {\r\n        link,\r\n        level: 1,\r\n        text\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nclass CodePage extends GitHubPage {\r\n  constructor () {\r\n    super()\r\n    const readme = document.querySelector('.markdown-body')\r\n    if (readme) {\r\n      this.headers = Array.from(readme.querySelectorAll(this._headerSelector))\r\n    }\r\n    this._validateHeaders()\r\n  }\r\n  /**\r\n   * @returns {Promise<HeaderList, Error>}\r\n   */\r\n  async getHeaderList () {\r\n    const isJSEnabled = await checkJSEnabled()\r\n    return this.headers.map(h => {\r\n      let { id, href } = h.querySelector('.anchor')\r\n      id = `#${id}`\r\n      href = new URL(href).hash\r\n      const link = isJSEnabled ? href : id\r\n      const level = Number(h.tagName[1])\r\n      const text = h.textContent.trim()\r\n      /**\r\n       * @type {HeaderObject}\r\n       */\r\n      return {\r\n        link,\r\n        level,\r\n        text\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nclass WikiPage extends GitHubPage {\r\n  constructor () {\r\n    super()\r\n    const markdown = document.querySelector('.wiki-body .markdown-body')\r\n    if (markdown) {\r\n      this.headers = Array.from(markdown.querySelectorAll(this._headerSelector))\r\n    }\r\n    this._validateHeaders()\r\n  }\r\n  /**\r\n   * @returns {Promise<HeaderList, Error>}\r\n   */\r\n  async getHeaderList () {\r\n    const isJSEnabled = await checkJSEnabled()\r\n    return this.headers.map(h => {\r\n      let { id, href } = h.querySelector('.anchor')\r\n      id = `#${id}`\r\n      href = new URL(href).hash\r\n      const link = isJSEnabled ? href : id\r\n      const level = Number(h.tagName[1])\r\n      const text = h.textContent.trim()\r\n      /**\r\n       * @type {HeaderObject}\r\n       */\r\n      return {\r\n        link,\r\n        level,\r\n        text\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nclass UnknownPage extends GitHubPage {\r\n}\r\n","import { Action } from '../modules/flux/index.js'\n// import fetchHeader from './get-header-data.js'\nimport GitHubPage from './page.js'\n\nexport const key = {\n  START_LOADING: Symbol('start-loading'),\n  MOVE_TO_PAGE: Symbol('move-to-page'),\n  TOGGLE_NAV: Symbol('toggle-nav')\n}\n\nexport default class AppAction extends Action {\n  startLoading () {\n    this.dispatch(key.START_LOADING)\n  }\n  async moveToPage () {\n    const page = GitHubPage.createFromUrl(location.href)\n    const headers = await page.getHeaderList()\n    const isAvailable = Boolean(headers.length)\n    const data = {\n      headers,\n      isAvailable\n    }\n    this.dispatch(key.MOVE_TO_PAGE, data)\n  }\n  toggleNav () {\n    this.dispatch(key.TOGGLE_NAV)\n  }\n}\n","import { Store } from '../modules/flux/index.js'\nimport { key } from './action.js'\n\nexport default class AppStore extends Store {\n  constructor (dispatcher) {\n    super(dispatcher)\n    this.setState({\n      isLoading: false,\n      isOpen: false,\n      isEnabled: false,\n      headers: []\n    })\n    this.register(key.START_LOADING, this.loading.bind(this))\n    this.register(key.MOVE_TO_PAGE, this.toPage.bind(this))\n    this.register(key.TOGGLE_NAV, this.toggleNav.bind(this))\n  }\n  loading () {\n    this.setState({\n      isLoading: true\n    })\n  }\n  toPage ({ isAvailable, headers }) {\n    this.setState({\n      headers,\n      isLoading: false,\n      isEnabled: isAvailable,\n      isOpen: isAvailable ? this.getState().isOpen : false\n    })\n  }\n  toggleNav () {\n    this.setState({\n      isOpen: !this.getState().isOpen\n    })\n  }\n}\n","'use strict'\n\nimport App from './app.html'\nimport { Dispatcher } from '../modules/flux/index.js'\nimport AppAction from './action.js'\nimport AppStore from './store.js'\n\nconst dispatcher = new Dispatcher()\nconst action = new AppAction(dispatcher)\nconst store = new AppStore(dispatcher)\n\nconst dataAttr = 'githubMarkdownTocOpen'\nconst body = document.body\n\nconst rootElm = document.createElement('github-markdown-toc-container')\nconst app = new App({\n  data: store.getState(),\n  target: rootElm\n})\nbody.appendChild(rootElm)\nstore.onChange(() => {\n  app.set(store.getState())\n})\nstore.onChange(() => {\n  const { isOpen } = store.getState()\n  if (isOpen) {\n    body.dataset[dataAttr] = ''\n  } else {\n    delete body.dataset[dataAttr]\n  }\n})\napp.on('toggle-nav', action.toggleNav.bind(action))\nwindow.addEventListener('pjax:start', action.startLoading.bind(action))\nwindow.addEventListener('pjax:end', action.moveToPage.bind(action))\n// init\naction.moveToPage()\n"],"names":["target","appendChild","node","insertBefore","anchor","parentNode","removeChild","start","i","iterations","length","destroy","detach","createElement","name","createTextNode","data","createComment","addEventListener","event","handler","removeEventListener","setAttribute","attribute","value","arguments","source","k","b","a","key","newState","oldState","differs","newValue","oldValue","group","callbacks","callback","__calling","call","component","_state","eventName","_handlers","slice","handlers","options","defer","_observers","post","pre","push","init","cancel","indexOf","index","splice","on","_set","assign","_root","_flush","_renderHooks","pop","hook","fn","context","get","fire","observe","set","methods","onBtnClicked","isEnabled","isLoading","isOpen","headers","header","level","link","text","constructor","has","type","add","off","delete","emit","forEach","func","obj","Object","getPrototypeOf","prototype","toString","proto","entries","isPlainObject","v","copy","copyObject","sources","map","copies","Symbol","_dispatcher","dispatcher","dispatch","setState","deepAssign","ON_CHANGE","getState","register","onChange","removeChangeListener","EventEmitter","RELEASE","CODE","WIKI","UNKNOWN","pathname","url","split","_type","user","project","getType","isReleasePage","isCodePage","isWikiPage","isUnknownPage","chrome","runtime","sendMessage","resolve","_headerSelector","_validateHeaders","filter","h","textContent","trim","pagetype","Array","from","document","querySelectorAll","href","querySelector","readme","id","hash","isJSEnabled","tagName","markdown","START_LOADING","MOVE_TO_PAGE","TOGGLE_NAV","startLoading","GitHubPage","createFromUrl","location","getHeaderList","isAvailable","toggleNav","loading","bind","toPage","action","store","dataAttr","body","rootElm","app","dataset","window","moveToPage"],"mappings":"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"}