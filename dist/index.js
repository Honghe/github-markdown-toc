(function b(c,d,g){function j(q,v){if(!d[q]){if(!c[q]){var w="function"==typeof require&&require;if(!v&&w)return w(q,!0);if(m)return m(q,!0);var x=new Error("Cannot find module '"+q+"'");throw x.code="MODULE_NOT_FOUND",x}var y=d[q]={exports:{}};c[q][0].call(y.exports,function(z){var A=c[q][1][z];return j(A?A:z)},y,y.exports,b,c,d,g)}return d[q].exports}for(var m="function"==typeof require&&require,p=0;p<g.length;p++)j(g[p]);return j})({1:[function(b,c){"use strict";function g(m){return!0===j(m)&&"[object Object]"===Object.prototype.toString.call(m)}var j=b("isobject");c.exports=function(p){var q,v;return!1!==g(p)&&(q=p.constructor,"function"==typeof q)&&(v=q.prototype,!1!==g(v)&&!1!==v.hasOwnProperty("isPrototypeOf"))}},{isobject:2}],2:[function(b,c){"use strict";c.exports=function(j){return null!=j&&"object"==typeof j&&!Array.isArray(j)}},{}],3:[function(b,c){function g(){}g.prototype={on:function(j,m,p){var q=this.e||(this.e={});return(q[j]||(q[j]=[])).push({fn:m,ctx:p}),this},once:function(j,m,p){function q(){v.off(j,q),m.apply(p,arguments)}var v=this;return q._=m,this.on(j,q,p)},emit:function(j){var m=[].slice.call(arguments,1),p=((this.e||(this.e={}))[j]||[]).slice(),q=0,v=p.length;for(q;q<v;q++)p[q].fn.apply(p[q].ctx,m);return this},off:function(j,m){var p=this.e||(this.e={}),q=p[j],v=[];if(q&&m)for(var w=0,x=q.length;w<x;w++)q[w].fn!==m&&q[w].fn._!==m&&v.push(q[w]);return v.length?p[j]=v:delete p[j],this}},c.exports=g},{}],4:[function(b,c){c.exports={MOVE_TO_PAGE:Symbol("move-to-page"),TOGGLE_NAV:Symbol("toggle-nav")}},{}],5:[function(b,c){const g=b("./action-type.js"),{key:j,checkPageType:m}=b("./check-page-type.js"),{fetchReleaseHeader:p,fetchMarkdownHeader:q,fetchWikiHeader:v}=b("./get-header-data.js");c.exports=class{constructor(x){this.dispatcher=x}async moveToPage(){let x;const y=m(location.href);x=y===j.RELEASE?p():y===j.CODE?await q():y===j.WIKI?await v():[];const z=!!x.length,A={headers:x,isAvailable:z};this.dispatcher.emit(g.MOVE_TO_PAGE,A)}toggleNav(){this.dispatcher.emit(g.TOGGLE_NAV)}}},{"./action-type.js":4,"./check-page-type.js":8,"./get-header-data.js":10}],6:[function(b,c){"use strict";function g(G,H){function I(){H.onBtnClicked()}var J=q("div");J.className="github-markdown-toc";var K=!G.isEnabled;p(J,"aria-disabled",K);var L=G.isOpen;p(J,"data-open",L);var M=q("nav");M.id="github-markdown-toc__nav-panel";var N=!G.isOpen;p(M,"aria-hidden",N),x(M,J);var O=q("ol");x(O,M);var P=y();x(P,O);for(var Q=G.headers,R=[],S=0;S<Q.length;S+=1)R[S]=j(G,Q,Q[S],S,H),R[S].mount(P.parentNode,P);x(A("\n  "),J);var T=q("button");T.type="button",B(T,"click",I),T.className="toggle-btn",p(T,"aria-controls","github-markdown-toc__nav-panel");var U=!G.isEnabled;return T.disabled=U,x(T,J),{mount:function(V,W){w(J,V,W)},update:function(V,W){var X;(X=!W.isEnabled)!=K&&(K=X,p(J,"aria-disabled",K)),(X=W.isOpen)!==L&&(L=X,p(J,"data-open",L)),(X=!W.isOpen)!=N&&(N=X,p(M,"aria-hidden",N));for(var Y=W.headers,Z=0;Z<Y.length;Z+=1)R[Z]?R[Z].update(V,W,Y,Y[Z],Z):(R[Z]=j(W,Y,Y[Z],Z,H),R[Z].mount(P.parentNode,P));z(R,!0,Y.length),R.length=Y.length,(X=!W.isEnabled)!=U&&(U=X,T.disabled=U)},teardown:function(V){z(R,!1),C(T,"click",I),V&&v(J)}}}function j(G,H,I){var L=q("li"),M=I.tag;L.className=M;var N=q("a"),O=I.link;N.href=O,x(N,L);var P=I.text,Q=A(P);return x(Q,N),{mount:function(R,S){w(L,R,S)},update:function(R,S,T,U){var W;(W=U.tag)!==M&&(M=W,L.className=M),(W=U.link)!==O&&(O=W,N.href=O),(W=U.text)!==P&&(Q.data=P=W)},teardown:function(R){R&&v(L)}}}function m(G){G=G||{},this._state=G.data||{},this._observers={pre:Object.create(null),post:Object.create(null)},this._handlers=Object.create(null),this._root=G._root,this._yield=G._yield,this._torndown=!1,this._fragment=g(this._state,this),G.target&&this._fragment.mount(G.target,null)}function p(G,H,I){G.setAttribute(H,I)}function q(G){return document.createElement(G)}function v(G){G.parentNode.removeChild(G)}function w(G,H,I){H.insertBefore(G,I)}function x(G,H){H.appendChild(G)}function y(){return document.createComment("")}function z(G,H,I){for(var J=I||0;J<G.length;J+=1)G[J].teardown(H)}function A(G){return document.createTextNode(G)}function B(G,H,I){G.addEventListener(H,I,!1)}function C(G,H,I){G.removeEventListener(H,I,!1)}function D(G,H,I,J){for(var K in H)if(K in I){var L=I[K],M=J[K];if(L!==M||"object"==typeof L){var N=H[K];if(N)for(var P,O=0;O<N.length;O+=1)P=N[O],P.__calling||(P.__calling=!0,P.call(G,L,M),P.__calling=!1)}}}var F=function(){return{methods:{onBtnClicked(){this.get("isEnabled")&&this.fire("toggle-nav")}}}}();m.prototype=F.methods,m.prototype.get=function(H){return H?this._state[H]:this._state},m.prototype.fire=function(H,I){var J=H in this._handlers&&this._handlers[H].slice();if(J)for(var K=0;K<J.length;K+=1)J[K].call(this,I)},m.prototype.observe=function(H,I,J){var K=J&&J.defer?this._observers.pre:this._observers.post;return(K[H]||(K[H]=[])).push(I),J&&!1===J.init||(I.__calling=!0,I.call(this,this._state[H]),I.__calling=!1),{cancel:function(){var L=K[H].indexOf(I);~L&&K[H].splice(L,1)}}},m.prototype.on=function(H,I){var J=this._handlers[H]||(this._handlers[H]=[]);return J.push(I),{cancel:function(){var K=J.indexOf(I);~K&&J.splice(K,1)}}},m.prototype.set=function(H){this._set(H),(this._root||this)._flush()},m.prototype._flush=function(){if(this._renderHooks)for(;this._renderHooks.length;){var H=this._renderHooks.pop();H.fn.call(H.context)}},m.prototype._set=function(H){var I=this._state;this._state=Object.assign({},I,H),D(this,this._observers.pre,H,I),this._fragment&&this._fragment.update(H,this._state),D(this,this._observers.post,H,I)},m.prototype.teardown=m.prototype.destroy=function(H){this.fire("teardown"),this._fragment.teardown(!1!==H),this._fragment=null,this._state={},this._torndown=!0},c.exports=m},{}],7:[function(b,c){c.exports=function(){return new Promise((j)=>{chrome.runtime.sendMessage({type:"is-js-enabled"},j)})}},{}],8:[function(b,c){const j={RELEASE:Symbol("release"),CODE:Symbol("code"),WIKI:Symbol("wiki"),UNKNOWN:Symbol("unknown")};c.exports={key:j,checkPageType:function(m){const{pathname:p}=new URL(m),[,q,v,...w]=p.split("/");if("releases"===w[0]&&1===w.length)return j.RELEASE;return"blob"===w[0]||"tree"===w[0]||q&&v&&!w.length?j.CODE:"wiki"===w[0]?j.WIKI:j.UNKNOWN}}},{}],9:[function(b,c){function g(p){let q={};return m(p)&&Object.keys(p).forEach((v)=>{m(p[v])&&(q[v]=g(p[v]))}),Object.assign({},p,q)}const m=b("is-plain-object");c.exports=function(p,...q){const v=q.map((w)=>g(w));return Object.assign(p,...v)}},{"is-plain-object":1}],10:[function(b,c){async function p(w){const x=await q(),y=Array.isArray(w)?w:Array.from(w);return y.map((z)=>{let{id:A,href:B}=z.querySelector(".anchor");A=`#${A}`,B=new URL(B).hash;const C=x?B:A,D=z.tagName.replace("H","lv"),F=z.textContent.trim();return{link:C,tag:D,text:F}})}const q=b("./check-js-enabled.js"),v="h1, h2, h3, h4, h5, h6";c.exports={fetchReleaseHeader:function(){const w=document.querySelectorAll(".release-title");return w?Array.from(w).map((x)=>{const{href:y}=x.querySelector("a"),A=x.textContent.trim();return{link:y,tag:"lv1",text:A}}):[]},fetchMarkdownHeader:async function(){const w=document.querySelector(".markdown-body");if(!w)return[];const x=w.querySelectorAll(v);return await p(x)},fetchWikiHeader:async function(){const w=document.querySelector(".wiki-body .markdown-body");if(!w)return[];let x=w.querySelectorAll(v);return x=Array.from(x).filter((y)=>{return!!y.textContent.trim()}),await p(x)}}},{"./check-js-enabled.js":7}],11:[function(b){"use strict";const g=b("./app.html"),j=b("tiny-emitter"),m=b("./action.js"),p=b("./store.js"),q=new j,v=new m(q),w=new p(q),x="githubMarkdownTocOpen",y=document.body,z=document.createElement("github-markdown-toc-container"),A=new g({data:w.getState(),target:z});y.appendChild(z),w.onChange(()=>{A.set(w.getState())}),w.onChange(()=>{const{isOpen:B}=w.getState();B?y.dataset[x]="":delete y.dataset[x]}),A.on("toggle-nav",v.toggleNav.bind(v)),window.addEventListener("pjax:end",v.moveToPage.bind(v)),v.moveToPage()},{"./action.js":5,"./app.html":6,"./store.js":12,"tiny-emitter":3}],12:[function(b,c){const g=b("tiny-emitter"),j=b("./deep-asign.js"),m=b("./action-type.js"),p=Symbol("on-change");c.exports=class extends g{constructor(v){super(),this.dispatcher=v,this.state={isOpen:!1,isEnabled:!1,headers:[]},this.dispatcher.on(m.MOVE_TO_PAGE,this.toPage.bind(this)),this.dispatcher.on(m.TOGGLE_NAV,this.toggleNav.bind(this))}toPage({isAvailable:v,headers:w}){this.setState({headers:w,isEnabled:v,isOpen:!!v&&this.state.isOpen})}toggleNav(){this.setState({isOpen:!this.state.isOpen})}setState(v){this.state=j({},this.state,v),this.emit(p)}onChange(v){this.on(p,v)}getState(){return j({},this.state)}}},{"./action-type.js":4,"./deep-asign.js":9,"tiny-emitter":3}]},{},[11]);
//# sourceMappingURL=index.js.map